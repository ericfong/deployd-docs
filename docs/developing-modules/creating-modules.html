<!DOCTYPE html>
<html lang="en" ng-app="docs">
  <head>
    
      <title>deployd</title>
    
    <link href='http://fonts.googleapis.com/css?family=Bitter:400,700,400italic' rel='stylesheet' type='text/css'>
    <link href="../../stylesheets/style.css" rel='stylesheet' type='text/css'>
    <link href="../../stylesheets/prettify.css" rel='stylesheet' type='text/css'>
    <script src="../../javascripts/libs/angular.js"></script>
    <script src="../../javascripts/libs/angular-sanitize.js"></script>
    <script src="../../javascripts/libs/jquery-1.8.2.js"></script>
    <script src="../../javascripts/libs/bootstrap.js"></script>
    <script src="../../javascripts/libs/jquery.highlight.js"></script>
    <script src="../../javascripts/libs/jquery.masonry.js"></script>
    <script src="../../javascripts/libs/prettify.js"></script>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-27539606-3']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>
  

  <body>
    <div class="navbar navbar-static-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="//deployd.com">
            <img src="//deployd.com/img/logo-text.png">
          </a>
          <div class="nav-collapse">
            <ul class="nav">
              <!--<li><a href="//cloud.deployd.com">cloud</a></li>-->
              <li class="active"><a href="//docs.deployd.com">docs</a></li>
              <li><a href="https://groups.google.com/forum/?fromgroups#!forum/deployd-users">community</a></li>
              <!--li><a href="//deployd.com/blog.html">blog</a></li-->
            </ul>
          </div><!--/.nav-collapse -->

          <div id="search" removed-ng-controller="SearchCtrl" class="pull-right">
  <form class="navbar-search" method="get" action="http://www.google.com/search">
    <input type="hidden" name="sitesearch" value="docs.deployd.com" />
    <input value="" placeholder="search docs" id="search-input" name="q" type="text" ng-change="change()" ng-model="input" />
  </form>
  <ul id="search-terms" class="typeahead unstyled" ng-show="terms.length" ng-cloak>
    <li ng-repeat="term in terms" class="{{ term.active && 'active' }}" ng-click="choose($index)">
      {{ term.title || term.reference }}
    </li>
  </ul>
</div>




          <div id="social" class="nav-collapse pull-left">
            <ul class="nav">
              <li><iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.1354270846.html#_=1354747685285&amp;count=horizontal&amp;id=twitter-widget-0&amp;lang=en&amp;original_referer=http%3A%2F%2Fdeployd.com%2F&amp;size=m&amp;text=Deployd%20Platform%20(%40deploydapp)%20-%20The%20simplest%20way%20to%20build%20APIs.&amp;url=http%3A%2F%2Fwww.deployd.com" class="twitter-share-button twitter-count-horizontal" style="width: 107px; height: 20px;" title="Twitter Tweet Button" data-twttr-rendered="true"></iframe>
      <script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script id="twitter-wjs" src="//platform.twitter.com/widgets.js"></script><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="navbar navbar-static-top secondary-nav">
      <div class="navbar-inner">
        <div class="container">
          <ul class="nav">
            <li class="home"><a href="../../">home</a></li>
            <li class="guides" ><a href="../../guides">guides</a></li>
            <li class="api"><a href="../../api">api</a></li>
            <li class="examples"><a href="../../examples">examples</a></li>
            <li class="modules"><a href="../../modules">modules</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      

<ul id="breadcrumb" class="unstyled">

  <li><a href="../../docs">Docs</a><span>/</span></li>

  <li>Developing Modules</li>
  
  <li>(<a href="../../docs/developing-modules/include-all.html">View All</a>)</li>
  
</ul>

<div id="browser" class="row">
  <div id="sidebar" class="span3">
    

<div id="explorer">
  <ul id="files" class="nav">
    
      <li class="active"><a href="../../docs/developing-modules/creating-modules.html"><i class="icon-file"></i> <span>Creating a Module</span></a></li>
    
      <li class=""><a href="../../docs/developing-modules/custom-resource-types.html"><i class="icon-file"></i> <span>Creating a Custom Resource Type</span></a></li>
    
    
  </ul>
  
  <ul id="dirs" class="nav">
  
      <li class=""><a href="../../docs/developing-modules/examples"><i class="icon-folder-close"></i> <span>Examples</span></a></li>
    
      <li class=""><a href="../../docs/developing-modules/internal-api"><i class="icon-folder-close"></i> <span>Internal API Reference</span></a></li>
    
  </ul>
  
</div>


    
      <h4>Related APIs</h4>
      <div id="related-apis">
        <div id="api">
  
      
        
            <ul class="nav nav-list developing-modules">
              <li class="nav-header"><a href="../../docs/developing-modules/internal-api/collection.html">Collection Resource Type</a></li>
            
      <li><a href="../../docs/developing-modules/internal-api/collection.html#s-collection.store-2358">collection.store</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/collection.html#s-collection.validate(body, create)-2358">collection.validate(body, create)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/collection.html#s-collection.sanitize(body)-2358">collection.sanitize(body)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/collection.html#s-collection.sanitizeQuery(query)-2358">collection.sanitizeQuery(query)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/collection.html#s-collection.parseId(ctx)-2358">collection.parseId(ctx)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/collection.html#s-collection.find(ctx, fn)-2358">collection.find(ctx, fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/collection.html#s-collection.remove(ctx, fn)-2358">collection.remove(ctx, fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/collection.html#s-collection.save(ctx, fn)-2358">collection.save(ctx, fn)</a></li>
    
            </ul>
            
            <ul class="nav nav-list developing-modules">
              <li class="nav-header"><a href="../../docs/developing-modules/internal-api/context.html">Context</a></li>
            
      <li><a href="../../docs/developing-modules/internal-api/context.html#s-ctx.done(err, result)-1333">ctx.done(err, result)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/context.html#s-ctx.body-1333">ctx.body</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/context.html#s-ctx.query-1333">ctx.query</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/context.html#s-ctx.method-1333">ctx.method</a></li>
    
            </ul>
            
            <ul class="nav nav-list developing-modules">
              <li class="nav-header"><a href="../../docs/developing-modules/internal-api/script.html">Event Scripts</a></li>
            
      <li><a href="../../docs/developing-modules/internal-api/script.html#s-script.run(ctx, domain, [fn])-1290">script.run(ctx, domain, [fn])</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/script.html#s-Script.load(path, fn)-1290">Script.load(path, fn)</a></li>
    
            </ul>
            
            <ul class="nav nav-list developing-modules">
              <li class="nav-header"><a href="../../docs/developing-modules/internal-api/resource.html">Resource Types</a></li>
            
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-resource.handle(ctx, next)-1405">resource.handle(ctx, next)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-resource.load(fn)-1405">resource.load(fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-resource.clientGeneration-1405">resource.clientGeneration</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-resource.config-1405">resource.config</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-Resource.events-1405">Resource.events</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-Resource.label-1405">Resource.label</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-Resource.defaultPath-1405">Resource.defaultPath</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-Collection.basicDashboard-1405">Collection.basicDashboard</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/resource.html#s-Collection.dashboard-1405">Collection.dashboard</a></li>
    
            </ul>
            
            <ul class="nav nav-list developing-modules">
              <li class="nav-header"><a href="../../docs/developing-modules/internal-api/server.html">Server</a></li>
            
      <li><a href="../../docs/developing-modules/internal-api/server.html#s-Server.listen([port], [host])-631">Server.listen([port], [host])</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/server.html#s-Server.createStore(namespace) -631">Server.createStore(namespace) </a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/server.html#s-Server.sockets-631">Server.sockets</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/server.html#s-Server.sessions-631">Server.sessions</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/server.html#s-Server.router-631">Server.router</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/server.html#s-Server.resources-631">Server.resources</a></li>
    
            </ul>
            
            <ul class="nav nav-list developing-modules">
              <li class="nav-header"><a href="../../docs/developing-modules/internal-api/session.html">Session</a></li>
            
      <li><a href="../../docs/developing-modules/internal-api/session.html#s-Session.set(changes)-1332">Session.set(changes)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/session.html#s-Session.save(fn)-1332">Session.save(fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/session.html#s-Session.fetch(fn)-1332">Session.fetch(fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/session.html#s-Session.remove(fn)-1332">Session.remove(fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/session.html#s-Session.emitToAll(event, data)-1332">Session.emitToAll(event, data)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/session.html#s-Session.emitToUsers(collection, query, event, data)-1332">Session.emitToUsers(collection, query, event, data)</a></li>
    
            </ul>
            
            <ul class="nav nav-list developing-modules">
              <li class="nav-header"><a href="../../docs/developing-modules/internal-api/session-store.html">Session Store</a></li>
            
      <li><a href="../../docs/developing-modules/internal-api/session-store.html#s-SessionStore.createSession(sid, fn)-1857">SessionStore.createSession(sid, fn)</a></li>
    
            </ul>
            
            <ul class="nav nav-list developing-modules">
              <li class="nav-header"><a href="../../docs/developing-modules/internal-api/store.html">Store</a></li>
            
      <li><a href="../../docs/developing-modules/internal-api/store.html#s-Store.insert(object, fn)-1117">Store.insert(object, fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/store.html#s-Store.count(query, fn)-1117">Store.count(query, fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/store.html#s-Store.find(query, fn)-1117">Store.find(query, fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/store.html#s-Store.first(query, fn)-1117">Store.first(query, fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/store.html#s-Store.update(query, changes, fn)-1117">Store.update(query, changes, fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/store.html#s-Store.remove(query, fn)-1117">Store.remove(query, fn)</a></li>
    
      <li><a href="../../docs/developing-modules/internal-api/store.html#s-Store.rename(name, fn)-1117">Store.rename(name, fn)</a></li>
    
            </ul>
            
      
    
</div>




      </div>
    
  </div>
  <div class="span9 sections">
    
      

  <div class="section"><a name="s-Creating a Module"></a><h2>Creating a Module <a class="anchor-link" href="#s-Creating a Module">#</a></h2><div class="section"><a name="s-Background-1588"></a><h3>Background <a class="anchor-link" href="#s-Background-1588">#</a></h3>

<p>Deployd modules are 100% compatible with regular <a href="http://npmjs.org">node modules</a>. This means you can use any of the 17,000+ node modules when building your Deployd app.</p></div><div class="section"><a name="s-Hello World-1588"></a><h3>Hello World <a class="anchor-link" href="#s-Hello World-1588">#</a></h3>

<p>Any module in your app's <code>node_modules</code> folder will be loaded when the Deployd server starts.</p>

<p>You don't have to <code>require()</code> or load anything to instantiate your module. The following will log 'hello world' when you run <code>dpd</code>.</p>

<pre><code>// /my-app/node_modules/hello.js
console.log('hello world');
</code></pre></div><div class="section"><a name="s-Accessing the Server-1588"></a><h3>Accessing the Server <a class="anchor-link" href="#s-Accessing the Server-1588">#</a></h3>

<p>In order to do anything interesting you need a reference to the current Deployd <a href="../../docs/developing-modules/internal-api/server.html">server</a> object. The server is always available at <code>process.server</code>. This means you don't need to require anything to use most of the <a href="../../docs/developing-modules/internal-api/collection.html">internal APIs</a>.</p></div><div class="section"><a name="s-One Off Modules-1588"></a><h3>One Off Modules <a class="anchor-link" href="#s-One Off Modules-1588">#</a></h3>

<p>The simplest kind of module is a <strong>one-off module</strong>. These are easy to create but hard to reuse. Typically any behavior that is specific to just your app that can't be implemented using an existing module can be built with a simple <strong>one-off module</strong>.</p>

<p>Here's an example one off module that maintains a count of requests to the url <code>/hits</code> and writes it to a file every minute.</p>

<pre><code>// /my-app/node_modules/hits.js
var fs = require('fs');
process.server.hits = 0;

process.server.on('request', function(req) {
  if(req.url === '/hits') {
    process.server.hits++;
  }
});

// write a file every minute
setInterval(function() {
  fs.writeFile('hits.json', JSON.stringify({hits: process.server.hits}));
}, 60000);
</code></pre></div><div class="section"><a name="s-Reusable Modules-1588"></a><h3>Reusable Modules <a class="anchor-link" href="#s-Reusable Modules-1588">#</a></h3>

<p>Modules can also expose useful APIs of their own. The simplest way to create reusable modules is to define a <code>Resource Type</code>. <code>Resource Types</code> are exposed in the dashboard and are much easier to reuse, and you can share them with other Deployd developers. See the <a href="../../docs/developing-modules/custom-resource-types.html">custom resource type guide</a> for more info.</p></div><div class="section"><a name="s-Debugging-1588"></a><h3>Debugging <a class="anchor-link" href="#s-Debugging-1588">#</a></h3>

<p>Deployd uses <a href="https://www.npmjs.com/package/debug">debug</a> to log requests and show other internal debug info. To activate it you need to set the <code>DEBUG</code> env variable to <code>*</code>, for example:</p>

<pre><code>process.env['DEBUG'] = '*';
</code></pre></div></div>  

    
    <h3 style="text-align: center;">More</h3>

    
    
    <div class="row-fluid">
      <div class="span6">
        <div class="well">
          <h4>Other docs in "Developing Modules"</h4>
          <ul>
            
              <li><a href="../../docs/developing-modules/custom-resource-types.html">Creating a Custom Resource Type</a></li>
            
              <li><a href="../../docs/developing-modules/examples">Examples</a></li>
            
              <li><a href="../../docs/developing-modules/internal-api">Internal API Reference</a></li>
            
          </ul>
        </div>
      </div>
       
        <div class="span6">
          <div class="well">
            <h4>Related Examples</h4>
            <ul>
              
                <li><a href="../../docs/developing-modules/examples/email.html">Email Resource</a></li>
              
                <li><a href="../../docs/developing-modules/examples/event.html">Event Resource</a></li>
              
                <li><a href="../../docs/developing-modules/examples/s3.html">S3 Bucket Resource</a></li>
              
            </ul>
          </div>
        </div>
      
    </div>
  </div>
</div>
    </div>
    
    <div class="docs-nav">
      <div class="container">
        <div class="row">
          <div class="span3">
            <h3>Guides</h3>
            <ul class="nav nav-list">
              
                <li><a href="../../docs/getting-started">Getting Started</a></li>
              
                <li><a href="../../docs/basics">Basics</a></li>
              
                <li><a href="../../docs/collections">Collections</a></li>
              
                <li><a href="../../docs/users">Users</a></li>
              
                <li><a href="../../docs/using-modules">Using Modules</a></li>
              
                <li><a href="../../docs/server">The Deployd Server</a></li>
              
                <li><a href="../../docs/developing-modules">Developing Modules</a></li>
              
            </ul>
          </div>
          <div class="span3">
            <h3>APIs</h3>
            <ul class="nav nav-list">
              
                <li class="nav-header"><a href="../../docs/collections/reference">Collections</a></li>
                
                  <li><a href="../../docs/collections/reference/event-api.html">Event API</a></li>
                
                  <li><a href="../../docs/collections/reference/http.html">Over HTTP</a></li>
                
                  <li><a href="../../docs/collections/reference/querying-collections.html">Querying Collections</a></li>
                
                  <li><a href="../../docs/collections/reference/updating-objects.html">Updating Objects in Collections</a></li>
                
                  <li><a href="../../docs/collections/reference/dpd-js.html">Using dpd.js</a></li>
                
              
                <li class="nav-header"><a href="../../docs/using-modules/reference">Using Modules</a></li>
                
                  <li><a href="../../docs/using-modules/reference/dpd-js.html">Dpd.js for Custom Resources</a></li>
                
                  <li><a href="../../docs/using-modules/reference/event-api.html">Event API for Custom Resources</a></li>
                
              
                <li class="nav-header"><a href="../../docs/developing-modules/internal-api">Developing Modules</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/collection.html">Collection Resource Type</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/context.html">Context</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/script.html">Event Scripts</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/internal-client.html">Internal Client</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/resource.html">Resource Types</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/server.html">Server</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/session.html">Session</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/session-store.html">Session Store</a></li>
                
                  <li><a href="../../docs/developing-modules/internal-api/store.html">Store</a></li>
                
              
            </ul>
          </div>
          <div class="span3">
            <h3>Examples</h3>
            <ul class="nav nav-list">
              
                <li class="nav-header"><a href="../../docs/collections">Collections</a></li>
                
                  <li><a href="../../docs">A Simple Todo App</a></li>
                
                  <li><a href="../../docs">A Simple Todo App with AngularJS</a></li>
                
                  <li><a href="../../docs">A Simple Todo App with Backbone.js</a></li>
                
                  <li><a href="../../docs">Chatroom</a></li>
                
              
                <li class="nav-header"><a href="../../docs/users">Users</a></li>
                
                  <li><a href="../../docs">Microblogging app</a></li>
                
                  <li><a href="../../docs">Simple Login Form</a></li>
                
              
                <li class="nav-header"><a href="../../docs/developing-modules">Developing Modules</a></li>
                
                  <li><a href="../../docs">Email Resource</a></li>
                
                  <li><a href="../../docs">Event Resource</a></li>
                
                  <li><a href="../../docs">S3 Bucket Resource</a></li>
                
              
            </ul>
          </div>
          <div class="span3">
            <div id="feedback">
              <h3>Feedback</h3>
              <p>Let us know if you have any ideas to improve our docs. Open an <a href="https://github.com/deployd/docs/issues">issue on github</a>, <a href="mailto: hello@deployd.com">send us an email</a>, or <a href="https://twitter.com/deploydapp">tweet us</a>.</p>
            </div>
            <div id="download">
              <h3>Edit or Download these Docs</h3>
              <p>This entire site, including documentation written in markdown is <a href="https://github.com/deployd/docs">available on github</a>. Pull requests are appreciated!</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer>
      <div class="container">
        <div class="row">
          <div class="span navigation">
            <dl>
              <dt><img src="//deployd.com/img/footer-dt.png" alt="deployd"></dt>
              <dd><a href="http://deployd.com/">Home</a></dd>
              <dd><a href="http://deployd.com/video.html">Screencast</a></dd>
              <dd><a href="http://deployd.com/features.html">Features</a></dd>
              <dd><a href="https://github.com/deployd/deployd/issues">Support</a></dd>
            </dl>
            <dl>
              <dt>documentation</dt>
              <dd><a href="http://docs.deployd.com/guides">Guides</a></dd>
              <dd><a href="http://docs.deployd.com/api">API</a></dd>
              <dd><a href="http://docs.deployd.com/examples">Examples</a></dd>
              <dd><a href="http://docs.deployd.com/modules">Modules</a></dd>
            </dl>
            <dl>
              <dt>community</dt>
              <dd><a href="http://deployd.com/community.html">Questions</a></dd>
              <dd><a href="https://twitter.com/deploydapp">Tweets</a></dd>
              <dd><a href="https://github.com/deployd/deployd/issues">Issues</a></dd>
              <dd><a href="https://github.com/deployd/deployd">Github</a></dd>
            </dl>
            <dl>
              <dt>contact</dt>
              <dd><a href="mailto:hello@deployd.com">hello@deployd.com</a></dd>
            </dl>
          </div>
          <div class="span logo-container">
            <div class="logo">
              <img src="//deployd.com/img/footer-logo.png" alt="deployd">
            </div>
          </div>
          <div class="span email-container">
            <dl id="mc_embed_signup" class="span4">
            <dt>Get deployd emails</dt>
            <dd>
              <form action="http://deployd.us2.list-manage.com/subscribe/post?u=4f1b944ba8c90738eb8e3fa3c&amp;id=7bb18e6b80" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate form-vertical" target="_blank" novalidate="">
              <div class="mc-field-group">
                <input type="email" placeholder="your@email" value="" name="EMAIL" class="required email" id="mce-EMAIL"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button btn">
              </div>
                <div id="mce-responses" class="clear">
                  <div class="response" id="mce-error-response" style="display:none"></div>
                  <div class="response" id="mce-success-response" style="display:none"></div>
                </div>
              </form>
            </dd>
          </dl>
          </div>
        </div>
      </div>
    </footer>
    <script src="../../javascripts/app.js"></script>
  </body>
</html>
